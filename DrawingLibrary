-- Drawing Library for Roblox Studio (ESP Ready Version)

local RunService = game:GetService("RunService")
local camera = workspace.CurrentCamera
local plr = game.Players.LocalPlayer

local Drawing = {}
Drawing.objects = {}

-- UI container
local screenGui = Instance.new("ScreenGui")
screenGui.IgnoreGuiInset = true
screenGui.Name = "Drawing_UI"
screenGui.ResetOnSpawn = false
screenGui.Parent = plr:WaitForChild("PlayerGui")

-- Helper: create Line
local function createLine()
	local frame = Instance.new("Frame")
	frame.AnchorPoint = Vector2.new(0.5,0.5)
	frame.BorderSizePixel = 0
	frame.BackgroundColor3 = Color3.new(1,1,1)
	frame.Visible = false
	frame.Parent = screenGui

	local obj = {
		Type = "Line",
		From = Vector2.new(0,0),
		To = Vector2.new(0,0),
		Color = Color3.new(1,1,1),
		Thickness = 1,
		Transparency = 1,
		Visible = false,
		_frame = frame
	}
	table.insert(Drawing.objects, obj)
	return obj
end

-- Helper: create Square (Box)
local function createSquare()
	local frame = Instance.new("Frame")
	frame.AnchorPoint = Vector2.new(0,0)
	frame.BorderSizePixel = 0
	frame.BackgroundColor3 = Color3.new(1,0,0)
	frame.Visible = false
	frame.Parent = screenGui
	
	local uistroke = Instance.new("UIStroke")
	uistroke.Thickness = 1
	uistroke.Color = Color3.new(1,1,1)
	uistroke.Parent = frame
	uistroke.LineJoinMode = Enum.LineJoinMode.Miter

	local obj = {
		Type = "Square",
		Position = Vector2.new(0,0),
		Size = Vector2.new(50,50),
		Color = Color3.new(1,0,0),
		Thickness = 1,
		Transparency = 0,
		Visible = false,
		_frame = frame,
		_stroke = uistroke,
	}
	table.insert(Drawing.objects, obj)
	return obj
end

-- Main constructor
function Drawing.new(typeName)
	if typeName == "Line" then
		return createLine()
	elseif typeName == "Square" then
		return createSquare()
	else
		error("Drawing type not supported: "..tostring(typeName))
	end
end

-- Update loop
RunService.RenderStepped:Connect(function()
	for _, obj in ipairs(Drawing.objects) do
		local frame = obj._frame
		if obj.Type == "Line" and obj.Visible then
			local from, to = obj.From, obj.To
			local dx, dy = to.X - from.X, to.Y - from.Y
			local dist = math.sqrt(dx*dx + dy*dy)
			local angle = math.atan2(dy, dx)
			frame.Position = UDim2.fromOffset((from.X + to.X)/2, (from.Y + to.Y)/2)
			frame.Size = UDim2.fromOffset(dist, obj.Thickness)
			frame.Rotation = math.deg(angle)
			frame.BackgroundColor3 = obj.Color
			frame.BackgroundTransparency = 1 - obj.Transparency
			frame.Visible = true
		elseif obj.Type == "Square" and obj.Visible then
			frame.Position = UDim2.fromOffset(obj.Position.X, obj.Position.Y)
			frame.Size = UDim2.fromOffset(obj.Size.X, obj.Size.Y)
			frame.BackgroundColor3 = obj.Color
			local stroke = obj._stroke
			stroke.Color = obj.Color
			stroke.Thickness = obj.Thickness
			frame.BackgroundTransparency = 1 - obj.Transparency
			frame.Visible = true
			stroke.Enabled = true
		else
			frame.Visible = false
		end
	end
end)

return Drawing
